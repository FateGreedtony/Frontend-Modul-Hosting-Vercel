<!doctype html>
<html lang="id">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Cek Konektifitas</title>
		<style>
			body {
				margin: 0;
				min-height: 100vh;
				display: grid;
				place-items: center;
			}

			.card {
				width: 700px;
				border: 1px solid black;
				border-radius: 10px;
				padding: 20px;
				box-shadow: 0 10px 30px rgba(0,0,0, 0.20);
			}

			h1 {
				margin: 0 0 5px;
				font-size: 30px;
			}

			p.desc {
				margin: 0 0 20px;
				font-size: 15px;
        text-align: center;
			}

			.actions { 
        display: flex;
        gap: 12px; 
        align-items: center; 
      }

			button {
				border: 1;
				padding: 12px;
				border-radius: 10px;
				background: rgb(0, 123, 255);
				color: white;
				font-weight: 600;
				cursor: pointer;
			}
      
			button:hover { background: rgb(0, 100, 210); }
			button:active { transform: translateY(1px); }

			.status { font-size: 14px; color: rgb(100, 100, 100); }
      .detail { font-size: 14px; margin-top: 16px; }
			.ok { color: rgb(0, 123, 255); }
			.err { color: rgb(200, 0, 20); }
		</style>
	</head>
	<body>
		<div class="card">
			<h1>Tes Hasil Hosting Backend & Frontend Dengan Vercel</h1>
			<p class="desc">Ini adalah halaman yang akan digunakan untuk mengecek konektifitas antara Frontend dengan Backend sesudah di-hosting di Vercel</p>
			<div class="actions">
				<button id="btn-cek">cek konektifitas</button>
				<span id="status" class="status">Belum dicek</span>
			</div>
			<pre id="detail" class="detail"></pre>
		</div>

		<script>
			const btn = document.getElementById('btn-cek');
			const statusEl = document.getElementById('status');
			const detailEl = document.getElementById('detail');

			async function cek() {
				btn.disabled = true;
				statusEl.className = 'status';
				statusEl.textContent = 'Mengecek koneksi...';
				detailEl.textContent = '';
				try {
					const ctrl = new AbortController();
					const timer = setTimeout(() => ctrl.abort(), 8000);
					const res = await fetch('/api/tesApi', { signal: ctrl.signal, headers: { 'Accept': 'application/json' } });
					clearTimeout(timer);
					if (!res.ok) throw new Error('HTTP ' + res.status);
					const data = await res.json();
					if (data && data.ok) {
						statusEl.className = 'status ok';
						statusEl.textContent = 'Terkoneksi dengan backend :^)';
					} else {
						statusEl.className = 'status err';
						statusEl.textContent = 'Invalid response dari backend';
					}
					detailEl.textContent = JSON.stringify(data, null, 2);
				} catch (err) {
					statusEl.className = 'status err';
					statusEl.textContent = 'Gagal terhubung ke backend :^(';
					detailEl.textContent = String(err && err.message ? err.message : err);
				} finally {
					btn.disabled = false;
				}
			}

			btn.addEventListener('click', cek);
		</script>
	</body>
	</html>

